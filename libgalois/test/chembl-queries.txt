match (f:compound_properties)-[:has_molecule]-(b:molecule_dictionary{oral:1})<-[:has_molecule]-(d:drug_indication{mesh_id:'D006333'}), (b)<-[:has_molecule]-(l:activities)-[:has_assay]->	
(r:assays)-[:has_target]->(t:target_dictionary)<-[:has_target]-(c:target_components)-[:has_comp_seq]->(o:component_sequences) where l.pchembl_value > 5.0 and f.full_mwt >= 199.0 return count(b);	
	
match (f:compound_properties)-[:has_molecule]-(b:molecule_dictionary{oral:1})-	
[:has_molecule]-(d:drug_indication{mesh_id:'D006333'}), (b)-[:has_molecule]-(l:activities)-[:has_assay]-	
(r:assays)-[:has_target]-(t:target_dictionary)-[:has_target]-(c:target_components)-[:has_comp_seq]-(o:component_sequences),	
(b)-[has_molecule]-(cc:compound_structures) where  l.pchembl_value > 5.0 and f.full_mwt >= 199 return b.molregno,count(t) as targets order by targets DESC limit 10	
	
match (f:compound_properties)-[:has_molecule]-(b:molecule_dictionary{oral:1})-[:has_molecule]-(d:drug_indication{mesh_id:'D006333'}),	
(b)-[:has_molecule]-(l:activities)-[:has_assay]-(r:assays)-[:has_target]-(t:target_dictionary)-[:has_target]-(c:target_components)-[:has_comp_seq]-(o:component_sequences),	
(b)-[has_molecule]-(cc:compound_structures) where  l.pchembl_value > 5.0 and f.full_mwt >= 199	
with distinct cc order by rdk_tanimoto_similarity(cc.canonical_smiles, 'c1ccccc1')	
match  (cc)-[:has_molecule]-(b:molecule_dictionary)-[:has_molecule]-(l:activities)-[:has_assay]-(r:assays)-[:has_target]-(t:target_dictionary)	
return cc.canonical_smiles, t.chembl_id_td order by cc.molregno_cs;	
	
match (b:molecule_dictionary)<-[:has_molecule]-(l:activities)-[:has_assay]->(r:assays)-[:has_target]->(t:target_dictionary{target_type:'SINGLE PROTEIN'}) return count(b)	
	
match (b:molecule_dictionary)<-[:has_molecule]-(l:activities)-[:has_assay]->(r:assays)-[:has_target]->(t:target_dictionary{target_type:'SINGLE PROTEIN', organism:'Mycobacterium tuberculosis'})  return count(b);	
	
match (b:molecule_dictionary{chembl_id:'CHEMBL941'})<-[:has_molecule]-(l:activities)-[:has_assay]->(r:assays)-[:has_target]->(t:target_dictionary)<-[:has_target]-(c:target_components) return count(b);	
	
match (b:molecule_dictionary)<-[:has_molecule]-(l:activities)-[:has_assay]->(r:assays)-[:has_target]->(t:target_dictionary{chembl_id_td:"CHEMBL1827"}) return count(b);	
